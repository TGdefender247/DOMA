<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirecting...</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body style="background:black; color:white; text-align:center; font-family:monospace; padding:50px;">
  <h1>⏳ Перенаправление…</h1>
  <script>
    const params = new URLSearchParams(window.location.search);
    const enc = params.get("link");
    const key = CryptoJS.enc.Utf8.parse("MySecretKey12345");

    try {
      const raw = CryptoJS.enc.Base64.parse(decodeURIComponent(enc));
      const iv = CryptoJS.lib.WordArray.create(raw.words.slice(0, 4));
      const ct = CryptoJS.lib.WordArray.create(raw.words.slice(4), raw.sigBytes - 16);

      const decrypted = CryptoJS.AES.decrypt({ ciphertext: ct }, key, {
        iv: iv,
        mode: CryptoJS.mode.CBC,
        padding: CryptoJS.pad.Pkcs7
      });

      const link = decrypted.toString(CryptoJS.enc.Utf8);
      window.location.href = link;
    } catch (e) {
      document.body.innerHTML = "<h1>Ошибка расшифровки ссылки</h1>";
    }
  </script>
</body>
</html>
